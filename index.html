<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Map Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- MapLibre -->
    <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css"
          rel="stylesheet" />
    <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>

    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        #map {
            position: absolute;
            inset: 0;
        }

        #upload {
            position: absolute;
            top: 12px;
            left: 12px;
            z-index: 10;
            background: #fff;
            padding: 8px 10px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

            #upload input {
                font-size: 13px;
            }

           .upload-button {
            display: inline-block;
            font-size: 13px;
            font-weight: 600;
            color: #1e40af;
            cursor: pointer;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px dashed #93c5fd;
            background: #eff6ff;
            transition: background 0.15s ease, border-color 0.15s ease;
        }

            .upload-button:hover {
                background: #dbeafe;
                border-color: #60a5fa;
            }


        .popup {
            font-size: 12px;
            max-height: 200px;
            overflow: auto;
        }

            .popup table {
                border-collapse: collapse;
            }

            .popup td {
                padding: 2px 6px;
                vertical-align: top;
                border-bottom: 1px solid #eee;
            }

                .popup td.key {
                    font-weight: 600;
                    white-space: nowrap;
                }

        #dropzone {
            position: absolute;
            inset: 0;
            z-index: 5;
            pointer-events: none;
        }

        body.dragging #dropzone {
            pointer-events: auto;
            outline: 3px dashed #4a90e2;
            outline-offset: -12px;
            background: rgba(74, 144, 226, 0.08);
        }



                #readonly-banner {
            position: absolute;
            bottom: 25px;
            right: 12px;
            z-index: 11;
            opacity: 0.85;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(4px);
            color: #444;
            font-size: 12px;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            user-select: none;
            pointer-events: none;
            box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }
            #readonly-banner:hover {
                opacity: 1;
            }

        body.view-mode #dropzone {
            display: none;
        }

        #empty-state {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 4;
            font-size: 18px;
            font-weight: 600;
            color: #1e40af; /* same family as PRIMARY_DARK */

            background: rgba(255, 255, 255, 0.9);
            padding: 14px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            pointer-events: none;
            user-select: none;
            text-align: center;
        }

        #share-box {
            position: absolute;
            top: 12px;
            right: 48px;
            z-index: 12;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            font-size: 12px;
            width: 260px;
            pointer-events: auto;
        }
            #share-box input {
                pointer-events: auto;
            }

        .share-label {
            font-weight: 600;
            margin-bottom: 6px;
            color: #1e40af;
        }

        .share-row {
            display: flex;
            gap: 6px;
        }

        #share-url {
            flex: 1;
            font-size: 12px;
            padding: 4px 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        #copy-btn {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #93c5fd;
            background: #eff6ff;
            cursor: pointer;
        }

            #copy-btn:hover {
                background: #dbeafe;
            }

        #files-panel {
            position: absolute;
            top: 70px;
            left: 12px;
            z-index: 12;
            width: 240px;
            max-height: calc(100vh - 100px);
            overflow: auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.12);
            padding: 10px;
            font-size: 12px;
        }

        .files-title {
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .file-row {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 6px;
            border-radius: 8px;
            cursor: pointer;
        }

            .file-row:hover {
                background: #eff6ff;
            }

        .file-eye {
            width: 22px;
            height: 22px;
            border-radius: 6px;
            border: 1px solid #93c5fd;
            background: #eff6ff;
            cursor: pointer;
            flex: 0 0 auto;
        }

            .file-eye:hover {
                background: #dbeafe;
            }

        .file-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: #111827;
        }

        .file-row {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .file-remove {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 12px;
            color: #999;
        }

            .file-remove:hover {
                color: #dc2626; /* subtle red */
            }







    </style>
</head>
<body>

    <div id="readonly-banner" hidden>
        View-only map · No editing
    </div>

    <div id="share-box" hidden>
        <div class="share-label">Shareable bundle link</div>
        <div class="share-row">
            <input id="share-url" readonly />
            <button id="copy-btn">Copy</button>
        </div>
    </div>

    <div id="files-panel" hidden>
        <div class="files-title">Files</div>
        <div id="files-list"></div>
    </div>

    <div id="upload">
        <label for="fileInput" class="upload-button">
            Drop GeoJSON anywhere or click to upload (30MB)
        </label>
        <input type="file" id="fileInput" accept=".geojson,.json" hidden />
    </div>


    <div id="dropzone"></div>

    <div id="empty-state">
        Drop a GeoJSON file to preview and share. Share limit: 30 MB.
    </div>

    <div id="map"></div>

    <script src="/app.js"></script>
</body>
</html>
